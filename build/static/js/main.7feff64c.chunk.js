(this["webpackJsonpgraph-tutorial"]=this["webpackJsonpgraph-tutorial"]||[]).push([[0],{118:function(e,t,a){},120:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(38),i=a.n(s),c=(a(80),a(5)),o=a(6),l=a(16),u=a(15),d=a(23),m=a(14),p=a(124),h=a(3),v=a.n(h),f=a(21),b=a(67),E={appId:"YOUR_APP_ID_HERE",redirectUri:"http://localhost:3000",scopes:["user.read","mailboxsettings.read","calendars.readwrite"]},g=a(28),y=a.n(g),k=a(44),O=a(44);function x(e){return O.Client.init({authProvider:function(t){t(null,e)}})}function j(e){return w.apply(this,arguments)}function w(){return(w=Object(f.a)(v.a.mark((function e(t){var a,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=x(t),e.next=3,a.api("/me").select("displayName,mail,mailboxSettings,userPrincipalName").get();case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e,t,a){return N.apply(this,arguments)}function N(){return(N=Object(f.a)(v.a.mark((function e(t,a,n){var r,s,i,c,o,l;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=x(t),s=n.format(),i=y()(n).add(7,"day").format(),e.next=5,r.api("/me/calendarview").header("Prefer",'outlook.timezone="'.concat(a,'"')).query({startDateTime:s,endDateTime:i}).select("subject,organizer,start,end").orderby("start/dateTime").top(50).get();case 5:if(!(c=e.sent)["@odata.nextLink"]){e.next=14;break}return o=[],l=new k.PageIterator(r,c,(function(e){return o.push(e),!0})),e.next=11,l.iterate();case 11:return e.abrupt("return",o);case 14:return e.abrupt("return",c.value);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t){return T.apply(this,arguments)}function T(){return(T=Object(f.a)(v.a.mark((function e(t,a){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=x(t),e.next=3,n.api("/me/events").post(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return function(t){Object(l.a)(n,t);var a=Object(u.a)(n);function n(e){var t;return Object(c.a)(this,n),(t=a.call(this,e)).publicClientApplication=void 0,t.state={error:null,isAuthenticated:!1,user:{}},t.publicClientApplication=new b.a({auth:{clientId:E.appId,redirectUri:E.redirectUri},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!0}}),t}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this.publicClientApplication.getAllAccounts();e&&e.length>0&&this.getUserProfile()}},{key:"render",value:function(){var t=this;return r.a.createElement(e,Object.assign({error:this.state.error,isAuthenticated:this.state.isAuthenticated,user:this.state.user,login:function(){return t.login()},logout:function(){return t.logout()},getAccessToken:function(e){return t.getAccessToken(e)},setError:function(e,a){return t.setErrorMessage(e,a)}},this.props))}},{key:"login",value:function(){var e=Object(f.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.publicClientApplication.loginPopup({scopes:E.scopes,prompt:"select_account"});case 3:return e.next=5,this.getUserProfile();case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.setState({isAuthenticated:!1,user:{},error:this.normalizeError(e.t0)});case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"logout",value:function(){this.publicClientApplication.logout()}},{key:"getAccessToken",value:function(){var e=Object(f.a)(v.a.mark((function e(t){var a,n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!((a=this.publicClientApplication.getAllAccounts()).length<=0)){e.next=4;break}throw new Error("login_required");case 4:return e.next=6,this.publicClientApplication.acquireTokenSilent({scopes:t,account:a[0]});case 6:return n=e.sent,e.abrupt("return",n.accessToken);case 10:if(e.prev=10,e.t0=e.catch(0),!this.isInteractionRequired(e.t0)){e.next=19;break}return e.next=15,this.publicClientApplication.acquireTokenPopup({scopes:t});case 15:return r=e.sent,e.abrupt("return",r.accessToken);case 19:throw e.t0;case 20:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getUserProfile",value:function(){var e=Object(f.a)(v.a.mark((function e(){var t,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getAccessToken(E.scopes);case 3:if(!(t=e.sent)){e.next=9;break}return e.next=7,j(t);case 7:a=e.sent,this.setState({isAuthenticated:!0,user:{displayName:a.displayName,email:a.mail||a.userPrincipalName,timeZone:a.mailboxSettings.timeZone,timeFormat:a.mailboxSettings.timeFormat},error:null});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),this.setState({isAuthenticated:!1,user:{},error:this.normalizeError(e.t0)});case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"setErrorMessage",value:function(e,t){this.setState({error:{message:e,debug:t}})}},{key:"normalizeError",value:function(e){var t={};if("string"===typeof e){var a=e.split("|");t=a.length>1?{message:a[1],debug:a[0]}:{message:e}}else t={message:e.message,debug:JSON.stringify(e)};return t}},{key:"isInteractionRequired",value:function(e){return!(!e.message||e.message.length<=0)&&(e.message.indexOf("consent_required")>-1||e.message.indexOf("interaction_required")>-1||e.message.indexOf("login_required")>-1||e.message.indexOf("no_account_in_silent_request")>-1)}}]),n}(r.a.Component)}var S=a(26),F=a(138),U=a(139),D=a(140),P=a(121),R=a(122),Y=a(69),_=a(123),B=a(125),I=a(126),q=a(127),z=a(128),Z=a(129);a(86);function W(e){return e.user.avatar?r.a.createElement("img",{src:e.user.avatar,alt:"user",className:"rounded-circle align-self-center mr-2",style:{width:"32px"}}):r.a.createElement("i",{className:"far fa-user-circle fa-lg rounded-circle align-self-center mr-2",style:{width:"32px"}})}function J(e){return e.isAuthenticated?r.a.createElement(F.a,null,r.a.createElement(U.a,{nav:!0,caret:!0},r.a.createElement(W,{user:e.user})),r.a.createElement(D.a,{right:!0},r.a.createElement("h5",{className:"dropdown-item-text mb-0"},e.user.displayName),r.a.createElement("p",{className:"dropdown-item-text text-muted mb-0"},e.user.email),r.a.createElement(P.a,{divider:!0}),r.a.createElement(P.a,{onClick:e.authButtonMethod},"Sign Out"))):r.a.createElement(R.a,null,r.a.createElement(Y.a,{onClick:e.authButtonMethod,className:"btn-link nav-link border-0",color:"link"},"Sign In"))}var L=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).toggle=n.toggle.bind(Object(S.a)(n)),n.state={isOpen:!1},n}return Object(o.a)(a,[{key:"toggle",value:function(){this.setState({isOpen:!this.state.isOpen})}},{key:"render",value:function(){var e=null;return this.props.isAuthenticated&&(e=r.a.createElement(R.a,null,r.a.createElement(d.b,{to:"/calendar",className:"nav-link",exact:!0},"Calendar"))),r.a.createElement("div",null,r.a.createElement(_.a,{color:"dark",dark:!0,expand:"md",fixed:"top"},r.a.createElement(p.a,null,r.a.createElement(B.a,{href:"/"},"React Graph Tutorial"),r.a.createElement(I.a,{onClick:this.toggle}),r.a.createElement(q.a,{isOpen:this.state.isOpen,navbar:!0},r.a.createElement(z.a,{className:"mr-auto",navbar:!0},r.a.createElement(R.a,null,r.a.createElement(d.b,{to:"/",className:"nav-link",exact:!0},"Home")),e),r.a.createElement(z.a,{className:"justify-content-end",navbar:!0},r.a.createElement(R.a,null,r.a.createElement(Z.a,{href:"https://developer.microsoft.com/graph/docs/concepts/overview",target:"_blank"},r.a.createElement("i",{className:"fas fa-external-link-alt mr-1"}),"Docs")),r.a.createElement(J,{isAuthenticated:this.props.isAuthenticated,authButtonMethod:this.props.authButtonMethod,user:this.props.user}))))))}}]),a}(r.a.Component),G=a(141),H=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=null;return this.props.debug&&(e=r.a.createElement("pre",{className:"alert-pre border bg-light p-2"},r.a.createElement("code",null,this.props.debug))),r.a.createElement(G.a,{color:"danger"},r.a.createElement("p",{className:"mb-3"},this.props.message),e)}}]),a}(r.a.Component),$=a(130);function K(e){return e.isAuthenticated?r.a.createElement("div",null,r.a.createElement("h4",null,"Welcome ",e.user.displayName,"!"),r.a.createElement("p",null,"Use the navigation bar at the top of the page to get started.")):r.a.createElement(Y.a,{color:"primary",onClick:e.authButtonMethod},"Click here to sign in")}var Q=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement($.a,null,r.a.createElement("h1",null,"React Graph Tutorial"),r.a.createElement("p",{className:"lead"},"This sample app shows how to use the Microsoft Graph API to access Outlook and OneDrive data from React"),r.a.createElement(K,{isAuthenticated:this.props.isAuthenticated,user:this.props.user,authButtonMethod:this.props.authButtonMethod}))}}]),a}(r.a.Component),V=a(131),X=a(18),ee=a.n(X),te=a(73),ae={"h:mm tt":"h:mm A","hh:mm tt":"hh:mm A"};function ne(e,t){if(void 0!==e)return y()(e).format(ae[t]||t)}var re=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e,t,a,n,s=y()().day()===(null===(e=this.props.date)||void 0===e?void 0:e.day())?"table-warning":"",i=this.props.timeFormat,c=r.a.createElement("td",{className:"calendar-view-date-cell",rowSpan:this.props.events.length<=0?1:this.props.events.length},r.a.createElement("div",{className:"calendar-view-date float-left text-right"},null===(t=this.props.date)||void 0===t?void 0:t.format("DD")),r.a.createElement("div",{className:"calendar-view-day"},null===(a=this.props.date)||void 0===a?void 0:a.format("dddd")),r.a.createElement("div",{className:"calendar-view-month text-muted"},null===(n=this.props.date)||void 0===n?void 0:n.format("MMMM, YYYY")));return this.props.events.length<=0?r.a.createElement("tr",{className:s},c,r.a.createElement("td",null),r.a.createElement("td",null)):r.a.createElement(r.a.Fragment,null,this.props.events.map((function(e,t){var a,n,o,l;return r.a.createElement("tr",{className:s,key:e.id},0===t&&c,r.a.createElement("td",{className:"calendar-view-timespan"},r.a.createElement("div",null,ne(null===(a=e.start)||void 0===a?void 0:a.dateTime,i)," - ",ne(null===(n=e.end)||void 0===n?void 0:n.dateTime,i))),r.a.createElement("td",null,r.a.createElement("div",{className:"calendar-view-subject"},e.subject),r.a.createElement("div",{className:"calendar-view-organizer"},null===(o=e.organizer)||void 0===o||null===(l=o.emailAddress)||void 0===l?void 0:l.name)))})))}}]),a}(r.a.Component),se=(a(118),M(function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={eventsLoaded:!1,events:[],startOfWeek:void 0},n}return Object(o.a)(a,[{key:"componentDidUpdate",value:function(){var e=Object(f.a)(v.a.mark((function e(){var t,a,n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.user||this.state.eventsLoaded){e.next=16;break}return e.prev=1,e.next=4,this.props.getAccessToken(E.scopes);case 4:return t=e.sent,a=Object(te.findOneIana)(this.props.user.timeZone),n=ee.a.tz(a.valueOf()).startOf("week").utc(),e.next=9,A(t,this.props.user.timeZone,n);case 9:r=e.sent,this.setState({eventsLoaded:!0,events:r,startOfWeek:n}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),this.props.setError("ERROR",JSON.stringify(e.t0));case 16:case"end":return e.stop()}}),e,this,[[1,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=ee()(this.state.startOfWeek),t=ee()(e).add(1,"day"),a=ee()(t).add(1,"day"),n=ee()(a).add(1,"day"),s=ee()(n).add(1,"day"),i=ee()(s).add(1,"day"),c=ee()(i).add(1,"day");return r.a.createElement("div",null,r.a.createElement("div",{className:"mb-3"},r.a.createElement("h1",{className:"mb-3"},e.format("MMMM D, YYYY")," - ",c.format("MMMM D, YYYY")),r.a.createElement(d.b,{to:"/newevent",className:"btn btn-light btn-sm",exact:!0},"New event")),r.a.createElement("div",{className:"calendar-week"},r.a.createElement("div",{className:"table-responsive"},r.a.createElement(V.a,{size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Date"),r.a.createElement("th",null,"Time"),r.a.createElement("th",null,"Event"))),r.a.createElement("tbody",null,r.a.createElement(re,{date:e,timeFormat:this.props.user.timeFormat,events:this.state.events.filter((function(t){var a;return ee()(null===(a=t.start)||void 0===a?void 0:a.dateTime).day()===e.day()}))}),r.a.createElement(re,{date:t,timeFormat:this.props.user.timeFormat,events:this.state.events.filter((function(e){var a;return ee()(null===(a=e.start)||void 0===a?void 0:a.dateTime).day()===t.day()}))}),r.a.createElement(re,{date:a,timeFormat:this.props.user.timeFormat,events:this.state.events.filter((function(e){var t;return ee()(null===(t=e.start)||void 0===t?void 0:t.dateTime).day()===a.day()}))}),r.a.createElement(re,{date:n,timeFormat:this.props.user.timeFormat,events:this.state.events.filter((function(e){var t;return ee()(null===(t=e.start)||void 0===t?void 0:t.dateTime).day()===n.day()}))}),r.a.createElement(re,{date:s,timeFormat:this.props.user.timeFormat,events:this.state.events.filter((function(e){var t;return ee()(null===(t=e.start)||void 0===t?void 0:t.dateTime).day()===s.day()}))}),r.a.createElement(re,{date:i,timeFormat:this.props.user.timeFormat,events:this.state.events.filter((function(e){var t;return ee()(null===(t=e.start)||void 0===t?void 0:t.dateTime).day()===i.day()}))}),r.a.createElement(re,{date:c,timeFormat:this.props.user.timeFormat,events:this.state.events.filter((function(e){var t;return ee()(null===(t=e.start)||void 0===t?void 0:t.dateTime).day()===c.day()}))}))))))}}]),a}(r.a.Component))),ie=a(30),ce=a(132),oe=a(133),le=a(134),ue=a(135),de=a(136),me=a(137),pe=M(function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={subject:"",attendees:"",start:"",end:"",body:"",disableCreate:!0,redirect:!1},n.handleUpdate=n.handleUpdate.bind(Object(S.a)(n)),n.isFormDisabled=n.isFormDisabled.bind(Object(S.a)(n)),n.createEvent=n.createEvent.bind(Object(S.a)(n)),n}return Object(o.a)(a,[{key:"handleUpdate",value:function(e){var t=Object(ie.a)({},e.target.name,e.target.value);this.setState(t)}},{key:"isFormDisabled",value:function(){return 0===this.state.subject.length||0===this.state.start.length||0===this.state.end.length}},{key:"createEvent",value:function(){var e=Object(f.a)(v.a.mark((function e(){var t,a,n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.attendees.split(";"),a=[],t.forEach((function(e){e.length>0&&a.push({emailAddress:{address:e}})})),n={subject:this.state.subject,attendees:a.length>0?a:void 0,start:{dateTime:this.state.start,timeZone:this.props.user.timeZone},end:{dateTime:this.state.end,timeZone:this.props.user.timeZone},body:this.state.body.length>0?{contentType:"text",content:this.state.body}:void 0},e.prev=4,e.next=7,this.props.getAccessToken(E.scopes);case 7:return r=e.sent,e.next=10,C(r,n);case 10:this.setState({redirect:!0}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),this.props.setError("ERROR",JSON.stringify(e.t0));case 16:case"end":return e.stop()}}),e,this,[[4,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.redirect?r.a.createElement(m.a,{to:"/calendar"}):r.a.createElement(ce.a,null,r.a.createElement(oe.a,null,r.a.createElement(le.a,{for:"subject"},"Subject"),r.a.createElement(ue.a,{type:"text",name:"subject",id:"subject",value:this.state.subject,onChange:this.handleUpdate})),r.a.createElement(oe.a,null,r.a.createElement(le.a,{for:"attendees"},"Attendees"),r.a.createElement(ue.a,{type:"text",name:"attendees",id:"attendees",placeholder:"Enter a list of email addresses, seperated by a semi-colon",value:this.state.attendees,onChange:this.handleUpdate})),r.a.createElement(de.a,{form:!0},r.a.createElement(me.a,null,r.a.createElement(oe.a,null,r.a.createElement(le.a,{for:"start"},"Start"),r.a.createElement(ue.a,{type:"datetime-local",name:"start",id:"start",value:this.state.start,onChange:this.handleUpdate}))),r.a.createElement(me.a,null,r.a.createElement(oe.a,null,r.a.createElement(le.a,{for:"end"},"End"),r.a.createElement(ue.a,{type:"datetime-local",name:"end",id:"end",value:this.state.end,onChange:this.handleUpdate})))),r.a.createElement(oe.a,null,r.a.createElement(le.a,{for:"body"},"Body"),r.a.createElement(ue.a,{type:"textarea",name:"body",id:"body",value:this.state.body,onChange:this.handleUpdate})),r.a.createElement(Y.a,{color:"primary",className:"mr-2",disabled:this.isFormDisabled(),onClick:this.createEvent},"Create"),r.a.createElement(d.b,{to:"/calendar",className:"btn btn-secondary",exact:!0},"Cancel"))}}]),a}(r.a.Component)),he=(a(119),M(function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=null;return this.props.error&&(t=r.a.createElement(H,{message:this.props.error.message,debug:this.props.error.debug})),r.a.createElement(d.a,null,r.a.createElement("div",null,r.a.createElement(L,{isAuthenticated:this.props.isAuthenticated,authButtonMethod:this.props.isAuthenticated?this.props.logout:this.props.login,user:this.props.user}),r.a.createElement(p.a,null,t,r.a.createElement(m.b,{exact:!0,path:"/",render:function(t){return r.a.createElement(Q,Object.assign({},t,{isAuthenticated:e.props.isAuthenticated,user:e.props.user,authButtonMethod:e.props.login}))}}),r.a.createElement(m.b,{exact:!0,path:"/calendar",render:function(t){return e.props.isAuthenticated?r.a.createElement(se,t):r.a.createElement(m.a,{to:"/"})}}),r.a.createElement(m.b,{exact:!0,path:"/newevent",render:function(t){return e.props.isAuthenticated?r.a.createElement(pe,t):r.a.createElement(m.a,{to:"/"})}}))))}}]),a}(n.Component)));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(he,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},75:function(e,t,a){e.exports=a(120)},80:function(e,t,a){}},[[75,1,2]]]);
//# sourceMappingURL=main.7feff64c.chunk.js.map